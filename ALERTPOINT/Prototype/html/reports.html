<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Dashboard with Gauge Charts</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .modern-gauge {
            position: relative;
            width: 220px;
            height: 220px;
            margin: 0 auto;
            background: linear-gradient(145deg, #f8fafc, #e2e8f0);
            border-radius: 50%;
            box-shadow: 
                20px 20px 60px #d1d9e6,
                -20px -20px 60px #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modern-gauge:hover {
            transform: translateY(-5px);
            box-shadow: 
                25px 25px 70px #d1d9e6,
                -25px -25px 70px #ffffff;
        }

        .gauge-inner {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: linear-gradient(145deg, #ffffff, #f1f5f9);
            box-shadow: 
                inset 8px 8px 16px #d1d9e6,
                inset -8px -8px 16px #ffffff;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .gauge-progress {
            position: absolute;
            top: -10px;
            left: -10px;
            width: 200px;
            height: 200px;
        }

        .gauge-text {
            text-align: center;
            z-index: 10;
        }

        .gauge-value {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 0.25rem;
        }

        .gauge-label {
            font-size: 0.875rem;
            color: #64748b;
            font-weight: 500;
        }

        .gauge-icon {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            color: white;
            z-index: 10;
        }

        .chart-container {
            height: 320px;
            position: relative;
            background: white;
            border-radius: 12px;
            padding: 1rem;
        }

        .metric-card {
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 
                8px 8px 20px rgba(0,0,0,0.1),
                -8px -8px 20px rgba(255,255,255,0.8);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 
                12px 12px 30px rgba(0,0,0,0.15),
                -12px -12px 30px rgba(255,255,255,0.9);
        }

        .status-indicator {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .temp-gradient { background: linear-gradient(135deg, #ff6b6b, #ffa726); }
        .humidity-gradient { background: linear-gradient(135deg, #4ecdc4, #26d0ce); }
        .water-gradient { background: linear-gradient(135deg, #3b82f6, #1e40af); }

        .metric-section {
            margin-bottom: 3rem;
        }

        .section-header {
            margin-bottom: 2rem;
            text-align: center;
        }

        .section-title {
            font-size: 1.875rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #1f2937, #4b5563);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto p-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-8">Environmental Monitoring Dashboard</h1>
        
        <!-- Current Time Display -->
        <div class="bg-white rounded-lg shadow-md p-4 mb-6">
            <div class="text-center">
                <h2 class="text-lg font-semibold text-gray-700">Current Time</h2>
                <p id="current-time" class="text-2xl font-mono text-blue-600"></p>
            </div>
        </div>

        <!-- Temperature Section -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Temperature Monitoring</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                
                <!-- Temperature Gauge -->
                <div class="metric-card relative">
                    <div class="status-indicator bg-orange-500"></div>
                    <div class="text-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Current Temperature</h3>
                    </div>
                    
                    <div class="modern-gauge">
                        <div class="gauge-icon temp-gradient">
                            <i class="fas fa-thermometer-half"></i>
                        </div>
                        <svg class="gauge-progress" viewBox="0 0 200 200">
                            <circle cx="100" cy="100" r="85" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                            <circle id="tempProgress" cx="100" cy="100" r="85" fill="none" 
                                    stroke="url(#tempGradient)" stroke-width="8" stroke-linecap="round"
                                    stroke-dasharray="534" stroke-dashoffset="534"
                                    transform="rotate(-90 100 100)" class="transition-all duration-1000 ease-out"/>
                            <defs>
                                <linearGradient id="tempGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:#ff6b6b"/>
                                    <stop offset="100%" style="stop-color:#ffa726"/>
                                </linearGradient>
                            </defs>
                        </svg>
                        <div class="gauge-inner">
                            <div class="gauge-text">
                                <div id="tempValue" class="gauge-value text-orange-600">28°C</div>
                                <div class="gauge-label">Temperature</div>
                                <div id="tempStatus" class="text-xs mt-1 font-medium text-green-600">Normal</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Temperature Trend -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Temperature Trend (24h)</h3>
                    <div class="chart-container">
                        <canvas id="temperatureTrendChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- AI Alert for Temperature -->
            <div class="ai-banner bg-orange-50 border-l-4 border-orange-400 p-4 rounded-lg mt-4">
                <div class="flex items-start">
                    <i class="fas fa-robot text-orange-400 text-lg mr-3 mt-1"></i>
                    <div>
                        <h3 class="text-sm font-medium text-orange-800">AI Temperature Insight</h3>
                        <p class="text-sm text-orange-700">Temperature levels are within normal range. Consider ventilation if temperature exceeds 32°C for extended periods.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Humidity Section -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Humidity Monitoring</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Humidity Gauge -->
                <div class="metric-card relative">
                    <div class="status-indicator bg-green-500"></div>
                    <div class="text-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Current Humidity</h3>
                    </div>
                    
                    <div class="modern-gauge">
                        <div class="gauge-icon humidity-gradient">
                            <i class="fas fa-tint"></i>
                        </div>
                        <svg class="gauge-progress" viewBox="0 0 200 200">
                            <circle cx="100" cy="100" r="85" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                            <circle id="humidityProgress" cx="100" cy="100" r="85" fill="none" 
                                    stroke="url(#humidityGradient)" stroke-width="8" stroke-linecap="round"
                                    stroke-dasharray="534" stroke-dashoffset="534"
                                    transform="rotate(-90 100 100)" class="transition-all duration-1000 ease-out"/>
                            <defs>
                                <linearGradient id="humidityGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:#4ecdc4"/>
                                    <stop offset="100%" style="stop-color:#26d0ce"/>
                                </linearGradient>
                            </defs>
                        </svg>
                        <div class="gauge-inner">
                            <div class="gauge-text">
                                <div id="humidityValue" class="gauge-value text-teal-600">75%</div>
                                <div class="gauge-label">Humidity</div>
                                <div id="humidityStatus" class="text-xs mt-1 font-medium text-green-600">Optimal</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Humidity Trend -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Humidity Trend (24h)</h3>
                    <div class="chart-container">
                        <canvas id="humidityTrendChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- AI Alert for Humidity -->
            <div class="ai-banner bg-green-50 border-l-4 border-green-400 p-4 rounded-lg mt-4">
                <div class="flex items-start">
                    <i class="fas fa-robot text-green-400 text-lg mr-3 mt-1"></i>
                    <div>
                        <h3 class="text-sm font-medium text-green-800">AI Humidity Insight</h3>
                        <p class="text-sm text-green-700">Humidity levels are optimal. Monitor for levels above 80% which may indicate poor ventilation.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Water Level Section -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Water Level Monitoring</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                 <!-- Water Level Gauge -->
                <div class="metric-card relative">
                    <div class="status-indicator bg-blue-500"></div>
                    <div class="text-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Current Water Level</h3>
                    </div>
                    
                    <div class="modern-gauge">
                        <div class="gauge-icon water-gradient">
                            <i class="fas fa-water"></i>
                        </div>
                        <svg class="gauge-progress" viewBox="0 0 200 200">
                            <circle cx="100" cy="100" r="85" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                            <circle id="waterProgress" cx="100" cy="100" r="85" fill="none" 
                                    stroke="url(#waterGradient)" stroke-width="8" stroke-linecap="round"
                                    stroke-dasharray="534" stroke-dashoffset="534"
                                    transform="rotate(-90 100 100)" class="transition-all duration-1000 ease-out"/>
                            <defs>
                                <linearGradient id="waterGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:#3b82f6"/>
                                    <stop offset="100%" style="stop-color:#1e40af"/>
                                </linearGradient>
                            </defs>
                        </svg>
                        <div class="gauge-inner">
                            <div class="gauge-text">
                                <div id="waterValue" class="gauge-value text-blue-600">0.4m</div>
                                <div class="gauge-label">Water Level</div>
                                <div id="waterStatus" class="text-xs mt-1 font-medium text-green-600">Safe</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Water Level Trend -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Water Level Trend (24h)</h3>
                    <div class="chart-container">
                        <canvas id="waterLevelChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- AI Alert for Water Level -->
            <div class="ai-banner bg-blue-50 border-l-4 border-blue-400 p-4 rounded-lg mt-4">
                <div class="flex items-start">
                    <i class="fas fa-robot text-blue-400 text-lg mr-3 mt-1"></i>
                    <div>
                        <h3 class="text-sm font-medium text-blue-800">AI Water Level Insight</h3>
                        <p class="text-sm text-blue-700">Water level is stable. Alert will be triggered if level drops below 0.2m or exceeds 0.8m.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
      // Global variables for charts and current values
        let temperatureTrendChart, humidityTrendChart, waterLevelChart;
        let currentTemp = 28;
        let currentHumidity = 75;
        let currentWaterLevel = 0.4;

        // Time display
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('en-PH', {
                timeZone: 'Asia/Manila',
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('current-time').textContent = timeString;
        }

        setInterval(updateTime, 1000);
        updateTime();

        // Database connection simulation - Replace with actual API calls
        async function fetchSensorData() {
            // This is where you'd make actual API calls to your database
            // Example:
            /*
            try {
                const response = await fetch('/api/sensor-data');
                const data = await response.json();
                return {
                    temperature: data.temperature,
                    humidity: data.humidity,
                    waterLevel: data.waterLevel,
                    timestamp: data.timestamp
                };
            } catch (error) {
                console.error('Error fetching sensor data:', error);
                return null;
            }
            */
            
            // Simulated data for demo
            return {
                temperature: 25 + Math.random() * 10,
                humidity: 60 + Math.random() * 30,
                waterLevel: 0.2 + Math.random() * 0.6,
                timestamp: new Date()
            };
        }

        // Update gauge progress
        function updateGaugeProgress(elementId, value, maxValue, minValue = 0) {
            const circle = document.getElementById(elementId);
            const circumference = 534; // 2 * Math.PI * 85
            const percentage = Math.min(Math.max((value - minValue) / (maxValue - minValue), 0), 1);
            const offset = circumference - (percentage * circumference);
            
            circle.style.strokeDashoffset = offset;
        }

        // Get status text based on value ranges
        function getTemperatureStatus(temp) {
            if (temp < 20) return { status: 'Cold', color: 'text-blue-600' };
            if (temp < 25) return { status: 'Cool', color: 'text-green-600' };
            if (temp < 30) return { status: 'Normal', color: 'text-green-600' };
            if (temp < 35) return { status: 'Warm', color: 'text-orange-600' };
            return { status: 'Hot', color: 'text-red-600' };
        }

        function getHumidityStatus(humidity) {
            if (humidity < 40) return { status: 'Dry', color: 'text-orange-600' };
            if (humidity < 60) return { status: 'Good', color: 'text-green-600' };
            if (humidity < 80) return { status: 'Optimal', color: 'text-green-600' };
            return { status: 'High', color: 'text-blue-600' };
        }

        function getWaterLevelStatus(level) {
            if (level < 0.2) return { status: 'Low', color: 'text-red-600' };
            if (level < 0.4) return { status: 'Medium', color: 'text-orange-600' };
            if (level < 0.7) return { status: 'Safe', color: 'text-green-600' };
            return { status: 'Full', color: 'text-blue-600' };
        }

        // Update all gauge displays
        function updateGaugeDisplays(temp, humidity, waterLevel) {
            // Temperature
            document.getElementById('tempValue').textContent = `${Math.round(temp)}°C`;
            const tempStatus = getTemperatureStatus(temp);
            const tempStatusEl = document.getElementById('tempStatus');
            tempStatusEl.textContent = tempStatus.status;
            tempStatusEl.className = `text-xs mt-1 font-medium ${tempStatus.color}`;
            updateGaugeProgress('tempProgress', temp, 50, 0);

            // Humidity
            document.getElementById('humidityValue').textContent = `${Math.round(humidity)}%`;
            const humidityStatus = getHumidityStatus(humidity);
            const humidityStatusEl = document.getElementById('humidityStatus');
            humidityStatusEl.textContent = humidityStatus.status;
            humidityStatusEl.className = `text-xs mt-1 font-medium ${humidityStatus.color}`;
            updateGaugeProgress('humidityProgress', humidity, 100, 0);

            // Water Level
            document.getElementById('waterValue').textContent = `${waterLevel.toFixed(1)}m`;
            const waterStatus = getWaterLevelStatus(waterLevel);
            const waterStatusEl = document.getElementById('waterStatus');
            waterStatusEl.textContent = waterStatus.status;
            waterStatusEl.className = `text-xs mt-1 font-medium ${waterStatus.color}`;
            updateGaugeProgress('waterProgress', waterLevel, 1, 0);
        }

        // Generate sample trend data
        function generateTrendData(baseValue, variance, points = 24) {
            return Array.from({ length: points }, (_, i) => ({
                time: `${String(i).padStart(2, '0')}:00`,
                value: Math.max(0, baseValue + (Math.random() - 0.5) * variance)
            }));
        }

        // Create trend chart
        function createTrendChart(canvasId, data, label, borderColor, backgroundColor, yAxisLabel) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.map(d => d.time),
                    datasets: [{
                        label: label,
                        data: data.map(d => d.value),
                        borderColor: borderColor,
                        backgroundColor: backgroundColor,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 2,
                        pointHoverRadius: 6,
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: { 
                                display: true, 
                                text: yAxisLabel,
                                color: '#64748b',
                                font: { weight: 'bold' }
                            },
                            grid: { color: '#f1f5f9' },
                            ticks: { color: '#64748b' }
                        },
                        x: {
                            grid: { color: '#f1f5f9' },
                            ticks: { color: '#64748b' }
                        }
                    }
                }
            });
        }

        // Initialize all charts and gauges
        async function initDashboard() {
            // Generate initial trend data
            const tempData = generateTrendData(28, 6).map(d => ({
                ...d, value: Math.max(15, Math.min(45, d.value))
            }));
            const humidityData = generateTrendData(75, 20).map(d => ({
                ...d, value: Math.max(30, Math.min(95, d.value))
            }));
            const waterData = generateTrendData(0.4, 0.4).map(d => ({
                ...d, value: Math.max(0.1, Math.min(0.9, d.value))
            }));

            // Create trend charts
            temperatureTrendChart = createTrendChart(
                'temperatureTrendChart', tempData, 'Temperature', 
                '#f59e0b', 'rgba(245, 158, 11, 0.1)', 'Temperature (°C)'
            );
            
            humidityTrendChart = createTrendChart(
                'humidityTrendChart', humidityData, 'Humidity',
                '#14b8a6', 'rgba(20, 184, 166, 0.1)', 'Humidity (%)'
            );
            
            waterLevelChart = createTrendChart(
                'waterLevelChart', waterData, 'Water Level',
                '#3b82f6', 'rgba(59, 130, 246, 0.1)', 'Water Level (m)'
            );

            // Initial gauge update
            updateGaugeDisplays(currentTemp, currentHumidity, currentWaterLevel);

            // Set up real-time updates
            setInterval(updateSensorData, 3000); // Update every 3 seconds
        }

        // Update sensor data - connects to database
        async function updateSensorData() {
            const sensorData = await fetchSensorData();
            
            if (sensorData) {
                currentTemp = sensorData.temperature;
                currentHumidity = sensorData.humidity;
                currentWaterLevel = sensorData.waterLevel;
                
                updateGaugeDisplays(currentTemp, currentHumidity, currentWaterLevel);
            }
        }

        // Initialize dashboard when DOM is loaded
        document.addEventListener('DOMContentLoaded', initDashboard);

        // Handle window resize
        window.addEventListener('resize', () => {
            [temperatureTrendChart, humidityTrendChart, waterLevelChart].forEach(chart => {
                if (chart) chart.resize();
            });
        });
    </script>
</body>
</html>